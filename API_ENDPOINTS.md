# üîó API Endpoints - Lauf System

## üìã –û–±–∑–æ—Ä –Ω–æ–≤—ã—Ö endpoint'–æ–≤

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API endpoints, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º –≤ —Å–∏—Å—Ç–µ–º—É Lauf –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram Bot –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á.

---

## ü§ñ Telegram Bot API

### Webhook –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç Telegram

**Endpoint**: `POST /api/telegram/webhook`  
**–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Å–Ω–æ–≤–Ω–æ–π webhook –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫–æ–º–∞–Ω–¥ –æ—Ç Telegram Bot  
**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (AllowAnonymous)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
```json
POST /api/telegram/webhook
Content-Type: application/json

{
  "update_id": 123456789,
  "message": {
    "message_id": 123,
    "from": {
      "id": 987654321,
      "first_name": "John",
      "username": "john_doe"
    },
    "chat": {
      "id": 987654321,
      "type": "private"
    },
    "date": 1635724800,
    "text": "/start"
  }
}
```

**–û—Ç–≤–µ—Ç**: `200 OK` (–≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200, —á—Ç–æ–±—ã Telegram –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–ª –æ—Ç–ø—Ä–∞–≤–∫—É)

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ webhook'–∞

**Endpoint**: `GET /api/telegram/webhook/status`  
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ Telegram webhook'–∞

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:
```json
{
  "status": "Active",
  "timestamp": "2023-11-01T12:00:00Z",
  "environment": "Development"
}
```

---

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook'–∞

**Endpoint**: `POST /api/telegram/webhook/test`  
**–û–ø–∏—Å–∞–Ω–∏–µ**: Endpoint –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è webhook'–∞ –≤ development –æ–∫—Ä—É–∂–µ–Ω–∏–∏

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
```json
POST /api/telegram/webhook/test
Content-Type: application/json

"–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ webhook'–∞"
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:
```json
{
  "message": "Webhook —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ",
  "receivedMessage": "–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ webhook'–∞",
  "timestamp": "2023-11-01T12:00:00Z"
}
```

---

## üìä Hangfire Dashboard

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á

**Endpoint**: `GET /hangfire`  
**–û–ø–∏—Å–∞–Ω–∏–µ**: Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–æ–Ω–æ–≤—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏  
**–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: –¢–æ–ª—å–∫–æ –≤ Development –æ–∫—Ä—É–∂–µ–Ω–∏–∏  
**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –û—Ç–∫—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø –≤ Development

**–§—É–Ω–∫—Ü–∏–∏ Dashboard:**
- üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
- ‚è∞ –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –∑–∞–¥–∞—á  
- üîÑ –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –∑–∞–¥–∞—á
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- üö´ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ failed –∑–∞–¥–∞—á–∞–º–∏

---

## üéØ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã Telegram Bot

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ |
|---------|----------|---------------|
| `/start` | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ | "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Lauf!" |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º | "üìö –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º Lauf Bot..." |
| `/progress` | –¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è | "üìà –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å: –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏: 2..." |
| `/pause` | –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | "‚è∏Ô∏è –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã" |
| `/resume` | –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | "‚ñ∂Ô∏è –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω—ã" |

### Callback –∫–Ω–æ–ø–∫–∏ (inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞)

| Callback Data | –û–ø–∏—Å–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|---------------|----------|----------|
| `start_flow_<ID>` | –ù–∞—á–∞—Ç—å –ø–æ—Ç–æ–∫ –æ–±—É—á–µ–Ω–∏—è | –ü–µ—Ä–µ—Ö–æ–¥ –≤ Web App –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ—Ç–æ–∫–∞ |
| `pause_flow_<ID>` | –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Ç–æ–∫ | –ü–∞—É–∑–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ |
| `view_achievement_<ID>` | –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è | –ü–µ—Ä–µ—Ö–æ–¥ –≤ Web App –∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º |

---

## ‚è∞ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á

### –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏

| –ó–∞–¥–∞—á–∞ | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|------------|----------|
| `daily-reminders` | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 9:00 | –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö |
| `deadline-checks` | –ö–∞–∂–¥—ã–µ 4 —á–∞—Å–∞ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–±–ª–∏–∂–∞—é—â–∏—Ö—Å—è –∏ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –¥–µ–¥–ª–∞–π–Ω–æ–≤ |

### Cron –≤—ã—Ä–∞–∂–µ–Ω–∏—è

```
"0 9 * * *"    - –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00
"0 */4 * * *"  - –ö–∞–∂–¥—ã–µ 4 —á–∞—Å–∞
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram –≤ appsettings.json

```json
{
  "TelegramBot": {
    "Token": "YOUR_BOT_TOKEN",
    "WebhookUrl": "https://yourdomain.com/api/telegram/webhook"
  }
}
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Hangfire

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "–≤–∞—à–∞_—Å—Ç—Ä–æ–∫–∞_–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"
  }
}
```

---

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–∞ –≤ Telegram

```bash
curl -X POST "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/setWebhook" \
  -H "Content-Type: application/json" \
  -d '{"url": "https://yourdomain.com/api/telegram/webhook"}'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è webhook'–∞

```bash
curl -X GET "https://yourdomain.com/api/telegram/webhook/status"
```

### –î–æ—Å—Ç—É–ø –∫ Hangfire Dashboard

```
http://localhost:5000/hangfire
```

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ API endpoints –ª–æ–≥–∏—Ä—É—é—Ç —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚ùå –û—à–∏–±–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è  
- üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üîç Debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ Development

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Telegram Webhook
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (–≤ TelegramAuthValidator)
- –í–∞–ª–∏–¥–∞—Ü–∏—è Web App –¥–∞–Ω–Ω—ã—Ö
- Rate limiting (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –≤ production)

### Hangfire Dashboard  
- –í Development: –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø
- –í Production: —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health Checks

**Endpoint**: `GET /health`  
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

### Metrics (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å)

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö webhook'–æ–≤
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á  
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥ Telegram Bot

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç —Ä–µ–ª–∏–∑–∞ —Å–∏—Å—Ç–µ–º—ã Lauf v1.0* 